# 📈 每日股票精选功能使用指南 - 优化版

## 🎯 功能概述

每日股票精选功能是在原有股票分析系统基础上新增的功能，能够从热点板块中自动筛选出值得关注的优质股票，并提供多维度评分和操作建议。

**🚀 2.0版本优化**：
- **智能股票池**：只分析前20个热点板块，每个板块前20只股票
- **运行时间**：从4小时缩短至30-60分钟
- **精选质量**：聚焦热点板块，提高精选股票的市场关注度

## ✨ 核心特性

### 🔍 智能筛选算法

#### 股票池构建策略
1. **获取热点板块**：实时获取概念板块涨跌幅排行
2. **选择TOP20板块**：选择当日表现最好的20个概念板块
3. **板块内精选**：每个板块选择前20只股票（按涨跌幅排序）
4. **去重优化**：去除重复股票，形成200-400只的精选股票池
5. **市值筛选**：优先选择50亿-5000亿市值的股票

#### 多维度评分体系
- **多维度评分**：技术面(40%) + 基本面(35%) + 流动性(25%)
- **分级推荐**：强烈推荐(90+分) / 推荐(75-89分) / 关注(60-74分)
- **精确点位**：买入价、止损价、目标价
- **风险提示**：自动识别追高风险、估值风险等

### 📊 评分体系

#### 技术面评分 (40%)
- **均线排列** (30分)：MA5>MA10>MA20 多头排列
- **乖离率安全性** (25分)：-2%~3% 为安全区间
- **量能配合** (25分)：温和放量最佳
- **K线形态** (20分)：连续上涨、震荡上行

#### 基本面评分 (35%)
- **估值水平** (40分)：PE 15-25 为合理区间
- **盈利能力** (30分)：ROE ≥15% 为优秀
- **成长性** (30分)：营收增长率 ≥20% 为高成长

#### 流动性评分 (25%)
- **成交额** (50分)：日成交额 ≥10亿 最佳
- **换手率** (30分)：2%-8% 为适中区间
- **量比** (20分)：1.2-3.0 为温和放量

### 🎛️ 筛选策略

1. **综合策略** (默认)：多维度综合评分
2. **趋势跟踪**：多头排列 + 突破
3. **价值挖掘**：低估值 + 基本面好
4. **动量策略**：强势股 + 量价配合
5. **反转策略**：超跌反弹 + 技术修复

## 🚀 使用方法

### 命令行使用

```bash
# 基础用法：运行股票精选
python main.py --stock-selection

# 自定义精选数量（默认20只）
python main.py --stock-selection --selection-count 30

# 指定筛选策略
python main.py --stock-selection --selection-strategy trend_following

# 不发送推送通知
python main.py --stock-selection --no-notify

# 调试模式
python main.py --stock-selection --debug
```

### 可用策略参数

- `comprehensive`：综合策略（默认）
- `trend_following`：趋势跟踪
- `value_hunting`：价值挖掘
- `momentum`：动量策略
- `reversal`：反转策略

### GitHub Actions 使用

在 GitHub Actions 中选择运行模式为 `selection-only` 即可运行股票精选功能。

## 📱 输出示例

```markdown
# 🎯 2026-01-19 每日股票精选

**精选统计**: 共15只 | 🔥强推:2 🟢推荐:8 🟡关注:5

## 强烈推荐 (2只)

### 🔥 贵州茅台(600519)
**综合评分**: 92.3分
**当前价格**: ¥1850.00
**操作建议**: 买入¥1820.00 | 止损¥1750.00 | 目标¥2100.00
**技术面**: 88.5分 | **基本面**: 95.0分 | **流动性**: 92.0分
**量比**: 1.35 | **换手率**: 0.85% | **PE**: 28.5
**推荐理由**: 技术面强势、基本面优秀、流动性充足

### 🔥 宁德时代(300750)
**综合评分**: 90.1分
**当前价格**: ¥185.50
**操作建议**: 买入¥182.00 | 止损¥175.00 | 目标¥210.00
**技术面**: 85.2分 | **基本面**: 92.8分 | **流动性**: 94.5分
**量比**: 2.15 | **换手率**: 3.2% | **PE**: 35.2
**推荐理由**: 技术面强势、基本面优秀、流动性充足
```

## ⚙️ 配置说明

### 🚀 性能对比

| 版本 | 股票池大小 | 运行时间 | 精选质量 | 说明 |
|------|------------|----------|----------|------|
| **1.0版本** | 全市场4000+只 | 3-4小时 | 全面但耗时 | 分析全市场所有股票 |
| **2.0版本** | 热点板块200-400只 | 20-40分钟 | 聚焦热点 | 只分析前20个热点板块 |

### 筛选参数（可在代码中调整）

```python
# 热点板块筛选
hot_sectors_count = 20       # 选择前20个热点板块
stocks_per_sector = 20       # 每个板块前20只股票
market_cap_range = (50e8, 5000e8)  # 市值范围：50亿-5000亿

# 基础筛选条件
min_market_cap = 50e8        # 最小市值50亿
min_daily_amount = 1e8       # 最小日成交额1亿
max_pe_ratio = 50            # 最大市盈率
min_volume_ratio = 1.2       # 最小量比

# 评分权重
weights = {
    'technical': 0.4,      # 技术面权重40%
    'fundamental': 0.35,   # 基本面权重35%
    'liquidity': 0.25      # 流动性权重25%
}
```

### 推荐级别阈值

- **强烈推荐**：90-100分
- **推荐**：75-89分
- **关注**：60-74分
- **观望**：40-59分
- **回避**：0-39分

## 🔧 技术实现

### 性能优化 - 2.0版本

#### 智能股票池构建
1. **热点板块识别**：实时获取概念板块涨跌幅排行
2. **TOP20板块选择**：选择当日表现最好的20个概念板块
3. **板块内精选**：每个板块选择前20只股票（按涨跌幅排序）
4. **市值筛选**：优先选择50亿-5000亿市值的股票
5. **去重优化**：最终形成200-400只的精选股票池

#### 性能提升
- **分析时间**：从4小时缩短至20-40分钟（提升85%）
- **股票池大小**：从4000+只缩减至200-400只（减少90%）
- **精选质量**：聚焦热点板块，提高市场关注度
- **请求优化**：减少延时至0.5-1.5秒，提高处理速度

### 防封禁策略
- 随机请求间隔：0.5-1.5秒（优化版）
- 多数据源切换：AkShare → Tushare → Baostock
- 智能重试机制：指数退避
- 市值预筛选：减少无效请求

### 数据来源
- **行情数据**：AkShare (东方财富) - **全部A股真实数据**
- **基本面数据**：实时行情接口 - **真实财务指标**
- **技术指标**：本地计算

> **数据真实性确认**：本系统使用的是来自东方财富网的全部A股真实交易数据，通过AkShare库的`ak.stock_zh_a_spot_em()`接口获取，覆盖约4000+只A股，包括上海证券交易所和深圳证券交易所的所有正常交易股票。数据为真实交易数据，非虚拟数据。详见 [数据来源确认说明](DATA_SOURCE_CONFIRMATION.md)。

### 性能优化
- 股票池采样：最多评估500只股票
- 并发控制：低并发防封禁
- 缓存机制：实时行情60秒缓存

## 📋 注意事项

### 使用限制
1. **数据延迟**：实时数据可能有15分钟延迟
2. **股票池大小**：分析200-400只热点板块股票（2.0版本优化）
3. **运行时间**：完整精选需要20-40分钟（大幅优化）

### 风险提示
1. **仅供参考**：精选结果不构成投资建议
2. **市场风险**：股市有风险，投资需谨慎
3. **数据准确性**：请以官方数据为准
4. **热点聚焦**：主要关注热点板块，可能错过冷门优质股

### 最佳实践
1. **定期运行**：建议每日收盘后运行
2. **结合分析**：配合原有的自选股分析使用
3. **动态调整**：根据市场情况调整筛选参数
4. **热点跟踪**：关注板块轮动，及时调整策略

## 🛠️ 故障排除

### 常见问题

**Q: 精选结果为空？**
A: 可能是筛选条件过严，尝试降低评分阈值或增加股票池大小

**Q: 运行速度慢？**
A: 减少精选数量或增加请求间隔时间

**Q: 数据获取失败？**
A: 检查网络连接，可能触发了反爬限制，稍后重试

### 调试方法

```bash
# 启用调试模式查看详细日志
python main.py --stock-selection --debug

# 测试股票精选功能
```bash
# 使用演示脚本测试
python demo_stock_selection.py
```

## 🔄 更新日志

### v1.0.0 (2026-01-19)
- ✅ 新增每日股票精选功能
- ✅ 多维度评分体系
- ✅ 5种筛选策略
- ✅ 自动生成精选报告
- ✅ 集成到主程序和GitHub Actions

---

**免责声明**: 本功能仅供学习和研究使用，不构成任何投资建议。股市有风险，投资需谨慎。